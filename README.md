# Тестовые задачи для курса AirFlow  
([https://airflow101.python-jitsu.club/](https://airflow101.python-jitsu.club/))

# Задача 1
## Насколько похорошела Москва
Напишите скрипт, который берёт данные о wi-fi точках в Московских библиотеках,
кинотеатрах, культурных центрах и парках (данные есть
[на data.mos.ru](https://data.mos.ru/opendata?categoryId=121)) и
считает, на какой улице больше всего халявных wi-fi точек.
Топ 5 улиц вывести в консоль.

## Решение
### Файлы
- Task_1.py - код решения
- data/ - директория с csv-файлами по точкам WiFi

### Предположения
- Файлы уже загружены локально 
- Парки не разделяются на улицы, рассматриваем как единый адрес для каждого парка
- Город Зеленоград не имеет улиц в адресе, рассматриваем город как единую улицу

### Алгоритм
- Обработка
	- Для библиотек, кинотеатров, культурных центров
		- Загрузить данные
		- Разделить колонки с помощью ";"
		- Удалить некорректные записи (записи заголовка)
		- Выделить колонки адреса и кол-ва WiFi-точек
		- Очистить данные
	- Для парков
		- Загрузить данные
		- Разделить колонки с помощью ";"
		- Удалить некорректные записи (записи заголовка)
		- Выделить колонку названия парка
		- Очистить данные
- Расчет
	- Рассчитать кол-во WiFi-точек для каждого полученного адреса из всех 4 источников данных

### Ответ
1. государственное автономное учреждение культуры города москвы «парк культуры и отдыха «сокольники»: 165
2. город зеленоград: 122
3. государственное бюджетное учреждение культуры города москвы «московский государственный объединенный художественный историко-архитектурный и природно-ландшафтный музей-заповедник», усадьба «коломенское»: 121
4. государственное автономное учреждение культуры города москвы «измайловский парк культуры и отдыха»: 120
5. государственное автономное учреждение города москвы «московский государственный зоологический парк»: 74

# Задача 2
## Статистика оказаний услуг
Есть таблица, в которой записаны услуги пациента в больнице: кто, где, когда, какая услуга.
Напишите SQL-запрос, который выведет топ 10 самых популярных услуг с указанием количества оказаний.

## Решение
### Файлы 
- Task_2.sql - файл с SQL-запросом

### Предположения
**Пример таблицы с данными**

CREATE TABLE services  
    ("patient" varchar(9), "hospital" varchar(10), "date" timestamp, "service_name" varchar(9));  
    
INSERT INTO services  
    ("patient", "hospital", "date", "service_name")  
VALUES  
    ('patient_A', 'hospital_A', '2020-05-01 00:00:00', 'service_A'),  
    ('patient_B', 'hospital_A', '2020-05-04 00:00:00', 'service_B'),  
    ('patient_A', 'hospital_B', '2020-05-01 00:00:00', 'service_B'),  
    ('patient_B', 'hospital_A', '2020-05-03 00:00:00', 'service_C'),  
    ('patient_A', 'hospital_C', '2020-05-01 00:00:00', 'service_C'),  
    ('patient_C', 'hospital_A', '2020-05-02 00:00:00', 'service_B');  

### Ответ
SELECT service_name,  COUNT(*) AS service_count  
FROM services  
GROUP BY service_name  
ORDER BY service_count DESC  
LIMIT 10;  

# Задача 3
## Обновление Python
`python3 -V` у вас выдаёт 3.7, вы хотите обновиться до 3.8. У вас Убунту или Макось.
Как вы будете это делать?

## Решение
### Файлы 
- Task_3.txt - файл с описанием обновления

### Предположения
- На системном уровне в OS установлен Python 3.7
- Для разработки, используются виртуальные окружения, созданные с помощью venv
- Текущее состояние: находимся в виртуальном окружении с названием py37

### Ответ
Save all installed packages in the py37 environment  
`pip freeze > requirements.txt`  

Deactivate current environment  
`deactivate`  

Update system version of python  
`sudo add-apt-repository ppa:deadsnakes/ppa`  
`sudo apt-get update`  
`sudo apt-get install python3.8`  
`sudo apt-get install python3.8-venv python3.8-dev`  
  
Create new environment  
`python -m venv py38`  

Activate new environment  
`source ./py38/bin/activate`  

Install all packages from the py37 environment  
pip install -r requirements.txt  